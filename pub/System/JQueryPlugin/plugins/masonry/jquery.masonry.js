(function(c,e,f){var a=e.event,b;a.special.smartresize={setup:function(){e(this).bind("resize",a.special.smartresize.handler)},teardown:function(){e(this).unbind("resize",a.special.smartresize.handler)},handler:function(j,g){var i=this,h=arguments;j.type="smartresize";if(b){clearTimeout(b)}b=setTimeout(function(){jQuery.event.handle.apply(i,h)},g==="execAsap"?0:100)}};e.fn.smartresize=function(g){return g?this.bind("smartresize",g):this.trigger("smartresize",["execAsap"])};e.Mason=function(g,h){this.element=e(h);this._create(g);this._init()};var d=["position","height"];e.Mason.settings={isResizable:true,isAnimated:false,animationOptions:{queue:false,duration:500},gutterWidth:0,isRTL:false,isFitWidth:false};e.Mason.prototype={_filterFindBricks:function(h){var g=this.options.itemSelector;return !g?h:h.filter(g).add(h.find(g))},_getBricks:function(h){var g=this._filterFindBricks(h).css({position:"absolute"}).addClass("masonry-brick");return g},_create:function(l){this.options=e.extend(true,{},e.Mason.settings,l);this.styleQueue=[];this.reloadItems();var k=this.element[0].style;this.originalStyle={};for(var m=0,h=d.length;m<h;m++){var n=d[m];this.originalStyle[n]=k[n]||null}this.element.css({position:"relative"});this.horizontalDirection=this.options.isRTL?"right":"left";this.offset={};var j=e(document.createElement("div"));this.element.prepend(j);this.offset.y=Math.round(j.position().top);if(!this.options.isRTL){this.offset.x=Math.round(j.position().left)}else{j.css({"float":"right",display:"inline-block"});this.offset.x=Math.round(this.element.outerWidth()-j.position().left)}j.remove();var g=this;setTimeout(function(){g.element.addClass("masonry")},0);if(this.options.isResizable){e(c).bind("smartresize.masonry",function(){g.resize()})}},_init:function(g){this._getColumns("masonry");this._reLayout(g)},option:function(g,h){if(e.isPlainObject(g)){this.options=e.extend(true,this.options,g)}},layout:function(s,v){var p,r,u,l,t,m;for(var o=0,q=s.length;o<q;o++){p=e(s[o]);r=Math.ceil(p.outerWidth(true)/this.columnWidth);r=Math.min(r,this.cols);if(r===1){this._placeBrick(p,this.colYs)}else{u=this.cols+1-r;l=[];for(m=0;m<u;m++){t=this.colYs.slice(m,m+r);l[m]=Math.max.apply(Math,t)}this._placeBrick(p,l)}}var g={};g.height=Math.max.apply(Math,this.colYs)-this.offset.y;if(this.options.isFitWidth){g.width=this.cols*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:g});var h=!this.isLaidOut?"css":(this.options.isAnimated?"animate":"css"),k=this.options.animationOptions;var n;for(o=0,q=this.styleQueue.length;o<q;o++){n=this.styleQueue[o];n.$el[h](n.style,k)}this.styleQueue=[];if(v){v.call(s)}this.isLaidOut=true},_getColumns:function(){var g=this.options.isFitWidth?this.element.parent():this.element,h=g.width();this.columnWidth=this.options.columnWidth||this.$bricks.outerWidth(true)||h;this.columnWidth+=this.options.gutterWidth;this.cols=Math.floor((h+this.options.gutterWidth)/this.columnWidth);this.cols=Math.max(this.cols,1)},_placeBrick:function(k,o){var g=Math.min.apply(Math,o),p=0;for(var j=0,m=o.length;j<m;j++){if(o[j]===g){p=j;break}}var l={top:g};l[this.horizontalDirection]=this.columnWidth*p+this.offset.x;this.styleQueue.push({$el:k,style:l});var n=g+k.outerHeight(true),h=this.cols+1-m;for(j=0;j<h;j++){this.colYs[p+j]=n}},resize:function(){var g=this.cols;this._getColumns("masonry");if(this.cols!==g){this._reLayout()}},_reLayout:function(h){var g=this.cols;this.colYs=[];while(g--){this.colYs.push(this.offset.y)}this.layout(this.$bricks,h)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(g){this.reloadItems();this._init(g)},appended:function(h,i,j){if(i){this._filterFindBricks(h).css({top:this.element.height()});var g=this;setTimeout(function(){g._appended(h,j)},1)}else{this._appended(h,j)}},_appended:function(g,i){var h=this._getBricks(g);this.$bricks=this.$bricks.add(h);this.layout(h,i)},remove:function(g){this.$bricks=this.$bricks.not(g);g.remove()},destroy:function(){this.$bricks.removeClass("masonry-brick").each(function(){this.style.position=null;this.style.top=null;this.style.left=null});var h=this.element[0].style;for(var j=0,g=d.length;j<g;j++){var k=d[j];h[k]=this.originalStyle[k]}this.element.unbind(".masonry").removeClass("masonry").removeData("masonry");e(c).unbind(".masonry")}};e.fn.imagesLoaded=function(k){var h=this.find("img"),g=h.length,j="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",i=this;if(!g){k.call(this);return this}h.bind("load",function(){if(--g<=0&&this.src!==j){k.call(i)}}).each(function(){if(this.complete||this.complete===f){var l=this.src;this.src=j;this.src=l}});return this};e.fn.masonry=function(h){if(typeof h==="string"){var g=Array.prototype.slice.call(arguments,1);this.each(function(){var i=e.data(this,"masonry");if(!i){return e.error("cannot call methods on masonry prior to initialization; attempted to call method '"+h+"'")}if(!e.isFunction(i[h])||h.charAt(0)==="_"){return e.error("no such method '"+h+"' for masonry instance")}i[h].apply(i,g)})}else{this.each(function(){var i=e.data(this,"masonry");if(i){i.option(h||{});i._init()}else{e.data(this,"masonry",new e.Mason(h,this))}})}return this}})(window,jQuery);